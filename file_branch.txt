code ini berasal dari raif branch
